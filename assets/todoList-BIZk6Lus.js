import{z as f,r as v,f as k,s as g}from"./index-DH2l403a.js";import{a as l}from"./index-NIGUFBhG.js";const $=f("user",()=>{const e=n=>{const i=`; ${document.cookie}`.split(`; ${n}=`);return i.length===2?i.pop().split(";").shift():null},c=v(e("customTodoToken")),a=v(e("nickname")?{nickname:e("nickname")}:null),u=k(()=>!!c.value);return{user:a,token:c,isLoggedIn:u,setUser:(n,r)=>{a.value={nickname:n},c.value=r,document.cookie=`customTodoToken=${r}; path=/;`,document.cookie=`nickname=${n.nickname}; path=/;`},logout:()=>{a.value=null,c.value=null,document.cookie="customTodoToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="nickname=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},initUser:()=>{const n=e("customTodoToken"),r=e("nickname")||null;n&&r&&(c.value=n,a.value={nickname:r})},getCookie:e}}),z=f("todoList",()=>{const e=v(!1),c=$(),{token:a}=g(c),u="https://todolist-api.hexschool.io",s=v([]),h=async()=>{e.value=!0;try{const o=await l.get(`${u}/todos/`,{headers:{Authorization:`${a.value.trim()}`}});s.value=o.data.data||[]}catch(o){console.error("Error:",o.response?.data||o.message)}e.value=!1},m=async o=>{e.value=!0;try{const t=await l.post(`${u}/todos/`,{content:o},{headers:{Authorization:`${a.value.trim()}`}});s.value.push(t.data.newTodo)}catch(t){console.error("Error:",t.response?.data||t.message)}e.value=!1},n=async o=>{e.value=!0;try{await l.delete(`${u}/todos/${o.id}`,{headers:{Authorization:`${a.value.trim()}`}}),s.value=s.value.filter(t=>t.id!==o.id)}catch(t){console.error("Error:",t.response?.data||t.message)}e.value=!1},r=async o=>{e.value=!0;try{const d=(await l.patch(`${u}/todos/${o.id}/toggle`,{},{headers:{Authorization:`${a.value.trim()}`}})).data;s.value=s.value.map(p=>p.id===d.id?d:p)}catch(t){console.error("Error:",t.response?.data||t.message)}e.value=!1},i=async o=>{e.value=!0;try{await l.put(`${u}/todos/${o.id}`,{content:o.content},{headers:{Authorization:`${a.value.trim()}`}});const t=s.value.find(d=>d.id===o.id);t&&(t.content=o.content)}catch(t){console.error(t)}e.value=!1},T=k(()=>s.value.filter(o=>o.status===!1).length);return{todoData:s,addTodo:m,removeTodo:n,undoneTodo:T,fetchTodos:h,toggleStatus:r,updateTodo:i,loading:e}});export{z as a,$ as u};
